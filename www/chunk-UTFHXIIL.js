import{A as X,C as Y,D as Z,G as $,H as x,I as ee,K as ie,c as k,e as V,f as D,l as H,m as O,n as z,p as G,q as R,r as K,s as J,t as Q}from"./chunk-NZTSZEPZ.js";import{a as B}from"./chunk-DADNZVRM.js";import{Ca as U,Ga as P,H as a,Ia as v,L as g,N as I,R as S,W as c,X as o,Y as s,Z as _,ea as M,l as C,ma as h,na as w,oa as E,qa as m,qb as F,r as b,ra as p,rb as W,sa as u,sb as L,tb as T,u as y,ub as q,xb as A,yb as N,zb as j}from"./chunk-3YJH32OC.js";import{e as f}from"./chunk-JHI3MBHO.js";var te=(()=>{let r=class r{constructor(i){this.http=i,this.apiUrl=B.apiUrl,this.userEndpoint=`${this.apiUrl}/users`}getUsers(){return this.http.get(this.userEndpoint)}getUser(i){return this.http.get(`${this.userEndpoint}/${i}`)}createUser(i){return this.http.post(this.userEndpoint,i)}updateUser(i,n){return this.http.put(`${this.userEndpoint}/${i}`,n)}deleteUser(i){return this.http.delete(`${this.userEndpoint}/${i}`)}};r.\u0275fac=function(n){return new(n||r)(y(v))},r.\u0275prov=b({token:r,factory:r.\u0275fac,providedIn:"root"});let d=r;return d})();function oe(d,r){d&1&&_(0,"ion-spinner")}var he=(()=>{let r=class r{constructor(i,n,e,l){this.modalCtrl=i,this.userService=n,this.loadingCtrl=e,this.alertCtrl=l,this.isEditMode=!1,this.name="",this.last_name="",this.email="",this.password="",this.password_confirmation="",this.isSubmitting=!1}ngOnInit(){this.isEditMode=!!this.user,this.isEditMode&&this.user&&(this.name=this.user.name,this.last_name=this.user.last_name,this.email=this.user.email)}cancel(){return this.modalCtrl.dismiss(null,"cancel")}saveUser(){return f(this,null,function*(){if(this.isSubmitting)return;if(this.password!==this.password_confirmation){yield this.presentAlert("Error","Las contrase\xF1as no coinciden.");return}this.isSubmitting=!0;let i=yield this.loadingCtrl.create({message:"Guardando usuario..."});yield i.present();let n;if(this.isEditMode&&this.user){let e={name:this.name,last_name:this.last_name,email:this.email};this.password&&(e.password=this.password),n=this.userService.updateUser(this.user.id,e)}else{if(!this.password||!this.password_confirmation){yield i.dismiss(),yield this.presentAlert("Error","La contrase\xF1a y su confirmaci\xF3n son requeridas para crear un nuevo usuario."),this.isSubmitting=!1;return}let e={name:this.name,last_name:this.last_name,email:this.email,password:this.password};n=this.userService.createUser(e)}n.pipe(C(()=>{i.dismiss(),this.isSubmitting=!1})).subscribe({next:e=>{this.presentAlert("\xC9xito",e.message||"Usuario guardado correctamente."),this.modalCtrl.dismiss(!0,"submit")},error:e=>{let l=e.error?.message||"Error al guardar. Verifique los datos.";this.presentAlert("Error",l),console.error(e)}})})}presentAlert(i,n){return f(this,null,function*(){yield(yield this.alertCtrl.create({header:i,message:n,buttons:["OK"]})).present()})}};r.\u0275fac=function(n){return new(n||r)(g(ee),g(te),g(x),g($))},r.\u0275cmp=I({type:r,selectors:[["app-user-form-modal"]],inputs:{user:"user"},decls:29,vars:12,consts:[["color","primary"],["slot","end"],[3,"click"],["slot","icon-only","name","close-outline"],[1,"ion-padding"],[3,"ngSubmit"],["label","Nombre","labelPlacement","floating","name","name","required","",3,"ngModelChange","ngModel"],["label","Apellido","labelPlacement","floating","name","last_name","required","",3,"ngModelChange","ngModel"],["label","Correo Electr\xF3nico","labelPlacement","floating","type","email","name","email","required","",3,"ngModelChange","ngModel"],[1,"ion-margin-top"],["label","Contrase\xF1a","labelPlacement","floating","type","password","name","password","minlength","8",3,"ngModelChange","ngModel","required"],["label","Confirmar Contrase\xF1a","labelPlacement","floating","type","password","name","password_confirmation","minlength","8",3,"ngModelChange","ngModel","required"],["expand","block","type","submit","color","secondary",1,"ion-margin-top",3,"disabled"],[4,"ngIf"]],template:function(n,e){n&1&&(o(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),h(3),s(),o(4,"ion-buttons",1)(5,"ion-button",2),M("click",function(){return e.cancel()}),_(6,"ion-icon",3),s()()()(),o(7,"ion-content",4)(8,"form",5),M("ngSubmit",function(){return e.saveUser()}),o(9,"ion-list")(10,"ion-list-header")(11,"ion-label"),h(12,"Datos de la Cuenta"),s()(),o(13,"ion-item")(14,"ion-input",6),u("ngModelChange",function(t){return p(e.name,t)||(e.name=t),t}),s()(),o(15,"ion-item")(16,"ion-input",7),u("ngModelChange",function(t){return p(e.last_name,t)||(e.last_name=t),t}),s()(),o(17,"ion-item")(18,"ion-input",8),u("ngModelChange",function(t){return p(e.email,t)||(e.email=t),t}),s()(),o(19,"ion-list-header",9)(20,"ion-label"),h(21),s()(),o(22,"ion-item")(23,"ion-input",10),u("ngModelChange",function(t){return p(e.password,t)||(e.password=t),t}),s()(),o(24,"ion-item")(25,"ion-input",11),u("ngModelChange",function(t){return p(e.password_confirmation,t)||(e.password_confirmation=t),t}),s()()(),o(26,"ion-button",12),S(27,oe,1,0,"ion-spinner",13),h(28),s()()()),n&2&&(a(3),w(e.isEditMode?"Editar Usuario":"Crear Usuario"),a(11),m("ngModel",e.name),a(2),m("ngModel",e.last_name),a(2),m("ngModel",e.email),a(3),w(e.isEditMode?"Cambiar Contrase\xF1a (Opcional)":"Contrase\xF1a (Requerida)"),a(2),m("ngModel",e.password),c("required",!e.isEditMode),a(2),m("ngModel",e.password_confirmation),c("required",!e.isEditMode),a(),c("disabled",e.isSubmitting),a(),c("ngIf",e.isSubmitting),a(),E(" ",e.isEditMode?"Actualizar Usuario":"Crear Usuario"," "))},dependencies:[ie,V,D,H,O,z,G,R,K,J,Q,X,Y,Z,k,P,U,j,q,F,W,A,N,T,L],encapsulation:2});let d=r;return d})();export{te as a,he as b};
