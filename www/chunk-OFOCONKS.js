import{a as Q,b as R}from"./chunk-UTFHXIIL.js";import{A as N,C as H,D as q,E as z,G,H as K,I as W,K as J,e as P,f as T,l as D,m as A,n as B,q as O,r as V,s as $,t as j}from"./chunk-NZTSZEPZ.js";import"./chunk-DBLGMTO4.js";import"./chunk-QUJFQN2Y.js";import"./chunk-O52IKJVK.js";import"./chunk-OQJCXMAZ.js";import"./chunk-VL6F45B6.js";import"./chunk-EU7FQ5IA.js";import"./chunk-STP2TL6J.js";import"./chunk-TCRGSDKV.js";import"./chunk-7FY2OE2O.js";import"./chunk-VBVQFYTF.js";import"./chunk-5EGKW7JY.js";import"./chunk-DM6TJFWJ.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-D7QNDGRV.js";import"./chunk-CKP3SGE2.js";import"./chunk-3IBBKVJY.js";import"./chunk-DADNZVRM.js";import{A as I,Ba as M,Ca as k,Ea as F,Ga as L,H as s,L as g,N as x,R as b,W as u,X as r,Y as n,Z as p,da as v,ea as f,fa as C,l as _,ma as m,na as E,oa as w,pa as U,wa as y,xa as S,z as h}from"./chunk-3YJH32OC.js";import"./chunk-Z6NEOT2M.js";import"./chunk-MSMJJC2X.js";import"./chunk-53OGNGEH.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-M2X7KQLB.js";import"./chunk-REYR55MP.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as d}from"./chunk-JHI3MBHO.js";function Y(o,a){o&1&&p(0,"ion-spinner")}function Z(o,a){if(o&1){let l=v();r(0,"ion-item",10)(1,"ion-label")(2,"h3"),m(3),n(),r(4,"p"),m(5),n(),r(6,"p",11),m(7),y(8,"date"),n()(),r(9,"ion-buttons",4)(10,"ion-button",12),f("click",function(){let e=h(l).$implicit,t=C();return I(t.openUserForm(e))}),p(11,"ion-icon",13),n(),r(12,"ion-button",14),f("click",function(){let e=h(l).$implicit,t=C();return I(t.deleteUser(e))}),p(13,"ion-icon",15),n()()()}if(o&2){let l=a.$implicit;s(3),U("",l.name," ",l.last_name),s(2),E(l.email),s(2),U("ID: ",l.id," | Creado: ",S(8,5,l.created_at))}}function ee(o,a){o&1&&(r(0,"ion-item")(1,"ion-label",16),m(2," No se encontraron usuarios o tienes un error de permisos. "),n()())}var ce=(()=>{let a=class a{constructor(i,e,t,c){this.userService=i,this.loadingCtrl=e,this.alertCtrl=t,this.modalCtrl=c,this.users=[],this.isLoading=!1}ngOnInit(){this.loadUsers()}loadUsers(){return d(this,null,function*(){this.isLoading=!0;let i=yield this.loadingCtrl.create({message:"Cargando usuarios..."});yield i.present(),this.userService.getUsers().pipe(_(()=>{this.isLoading=!1,i.dismiss()})).subscribe({next:e=>{this.users=e.data},error:e=>{console.error("Error al cargar usuarios:",e),this.presentAlert("Error","No se pudieron cargar los usuarios."),this.users=[]}})})}openUserForm(i){return d(this,null,function*(){let e=yield this.modalCtrl.create({component:R,componentProps:{user:i}});yield e.present();let{role:t}=yield e.onWillDismiss();t==="submit"&&this.loadUsers()})}deleteUser(i){return d(this,null,function*(){yield(yield this.alertCtrl.create({header:"Confirmar Eliminaci\xF3n",message:`\xBFEst\xE1s seguro de que deseas eliminar al usuario ${i.name} (${i.email})?`,buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",cssClass:"danger",handler:()=>d(this,null,function*(){let t=yield this.loadingCtrl.create({message:"Eliminando..."});yield t.present(),this.userService.deleteUser(i.id).pipe(_(()=>t.dismiss())).subscribe({next:c=>{this.presentAlert("\xC9xito",c.message||"Usuario eliminado."),this.loadUsers()},error:c=>{let X=c.error?.message||"Error al eliminar usuario.";this.presentAlert("Error",X),console.error(c)}})})}]})).present()})}presentAlert(i,e){return d(this,null,function*(){yield(yield this.alertCtrl.create({header:i,message:e,buttons:["OK"]})).present()})}};a.\u0275fac=function(e){return new(e||a)(g(Q),g(K),g(G),g(W))},a.\u0275cmp=x({type:a,selectors:[["app-user-management"]],decls:17,vars:6,consts:[[3,"translucent"],["color","tertiary"],["slot","start"],["defaultHref","/tabs/tab4/dashboard"],["slot","end"],[3,"click"],["slot","icon-only","name","person-add-outline"],[3,"fullscreen"],[4,"ngIf"],["lines","full",4,"ngFor","ngForOf"],["lines","full"],[1,"ion-text-wrap"],["color","secondary",3,"click"],["slot","icon-only","name","create-outline"],["color","danger",3,"click"],["slot","icon-only","name","trash-outline"],[1,"ion-text-center","ion-padding"]],template:function(e,t){e&1&&(r(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),p(3,"ion-back-button",3),n(),r(4,"ion-title"),m(5,"\u{1F465} Gesti\xF3n de Usuarios"),n(),r(6,"ion-buttons",4)(7,"ion-button",5),f("click",function(){return t.openUserForm()}),p(8,"ion-icon",6),n()()()(),r(9,"ion-content",7)(10,"ion-list")(11,"ion-list-header")(12,"ion-label"),m(13),n(),b(14,Y,1,0,"ion-spinner",8),n(),b(15,Z,14,7,"ion-item",9)(16,ee,3,0,"ion-item",8),n()()),e&2&&(u("translucent",!0),s(9),u("fullscreen",!0),s(4),w("Lista de Usuarios (",t.users.length,")"),s(),u("ngIf",t.isLoading),s(),u("ngForOf",t.users),s(),u("ngIf",!t.isLoading&&t.users.length===0))},dependencies:[J,P,T,D,A,B,O,V,$,j,N,H,q,z,L,M,k,F],encapsulation:2});let o=a;return o})();export{ce as UserManagementPage};
