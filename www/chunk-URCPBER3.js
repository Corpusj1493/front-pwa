import{a as h}from"./chunk-DADNZVRM.js";import{Ia as u,d as n,m as l,n as o,r as c,u as p}from"./chunk-3YJH32OC.js";var r="auth_token",i="user_data",I=(()=>{let a=class a{constructor(t){this.http=t,this.apiUrl=h.apiUrl}loadUserData(){return this.http.get(`${this.apiUrl}/me`).pipe(o(t=>{t.success&&t.data&&localStorage.setItem(i,JSON.stringify(t.data))}))}getToken(){return localStorage.getItem(r)}getUserData(){let t=localStorage.getItem(i);return t?JSON.parse(t):null}login(t){return this.http.post(`${this.apiUrl}/login`,t).pipe(o(e=>{e.success&&e.data.token&&localStorage.setItem(r,e.data.token)}),l(e=>e.success&&e.data.token?this.loadUserData():n(e)))}register(t){return this.http.post(`${this.apiUrl}/register`,t).pipe(o(e=>{e.success&&e.token&&(localStorage.setItem(r,e.token),localStorage.setItem(i,JSON.stringify(e.data)))}))}logout(){return this.http.post(`${this.apiUrl}/logout`,{}).pipe(o(()=>{localStorage.removeItem(r),localStorage.removeItem(i)}))}isAuthenticated(){return!!this.getToken()}hasRole(t){return this.getUserData()?.roles?.includes(t)??!1}isAdmin(){return this.hasRole("admin")}};a.\u0275fac=function(e){return new(e||a)(p(u))},a.\u0275prov=c({token:a,factory:a.\u0275fac,providedIn:"root"});let s=a;return s})();export{I as a};
