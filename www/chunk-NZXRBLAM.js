import{B as m,D as f,Ga as j,I as c,J as h,K as w,L as s,N as b,O as E,P as v,Q as y,Z as I,ja as x,ka as k,la as z,nb as S,pb as A,q as C,r as u,s as g,u as p,ua as D}from"./chunk-3YJH32OC.js";var N=["captchaWrapperElem"],l=(()=>{class t{zone;scriptElemId="ngx-catpcha-script";windowGrecaptcha="grecaptcha";windowGrecaptchaEnterprise="enterprise";windowOnLoadCallbackProperty="ngx_captcha_onload_callback";windowOnLoadEnterpriseCallbackProperty="ngx_captcha_onload_enterprise_callback";globalDomain="recaptcha.net";defaultDomain="google.com";enterpriseApi="enterprise.js";defaultApi="api.js";constructor(e){this.zone=e}registerCaptchaScript(e,i,r,a){if(this.grecaptchaScriptLoaded(e.useEnterprise)){e.useEnterprise?this.zone.run(()=>{r(window[this.windowGrecaptcha][this.windowGrecaptchaEnterprise])}):this.zone.run(()=>{r(window[this.windowGrecaptcha])});return}e.useEnterprise?window[this.getCallbackName(!0)]=()=>this.zone.run(r.bind(this,window[this.windowGrecaptcha][this.windowGrecaptchaEnterprise])):window[this.getCallbackName(!1)]=()=>this.zone.run(r.bind(this,window[this.windowGrecaptcha]));let n=document.createElement("script");n.id=this.scriptElemId,n.innerHTML="",n.src=this.getCaptchaScriptUrl(e,i,a),n.async=!0,n.defer=!0,document.getElementsByTagName("head")[0].appendChild(n)}cleanup(){let e=document.getElementById(this.scriptElemId);e&&e.remove(),window[this.getCallbackName()]=void 0,window[this.windowGrecaptcha]=void 0}grecaptchaScriptLoaded(e){return!window[this.getCallbackName(e)]||!window[this.windowGrecaptcha]?!1:e&&window[this.windowGrecaptcha][this.windowGrecaptchaEnterprise]?!0:!!window[this.windowGrecaptcha].execute}getCallbackName(e){return e?this.windowOnLoadEnterpriseCallbackProperty:this.windowOnLoadCallbackProperty}getLanguageParam(e){return e?`&hl=${e}`:""}getCaptchaScriptUrl(e,i,r){let a=e.useGlobalDomain?this.globalDomain:this.defaultDomain,n=e.useEnterprise?this.enterpriseApi:this.defaultApi,o=this.getCallbackName(e.useEnterprise);return`https://www.${a}/recaptcha/${n}?onload=${o}&render=${i}${this.getLanguageParam(r)}`}static \u0275fac=function(i){return new(i||t)(p(h))};static \u0275prov=u({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),P=(()=>{class t{renderer;zone;injector;scriptService;captchaElemPrefix="ngx_captcha_id_";setupCaptcha=!0;siteKey;useGlobalDomain=!1;useEnterprise=!1;type="image";hl;tabIndex=0;success=new c;load=new c;reset=new c;ready=new c;error=new c;expire=new c;setupAfterLoad=!1;captchaElem;captchaId;currentResponse;resetCaptchaAfterSuccess=!1;onChange=e=>{};onTouched=e=>{};isLoaded=!1;reCaptchaApi;captchaElemId;control;constructor(e,i,r,a){this.renderer=e,this.zone=i,this.injector=r,this.scriptService=a}ngAfterViewInit(){this.control=this.injector.get(A,void 0,{optional:!0})?.control}ngAfterViewChecked(){this.setupCaptcha&&(this.setupCaptcha=!1,this.setupComponent())}ngOnChanges(e){e&&e.hl&&!e.hl.firstChange&&e.hl.currentValue!==e.hl.previousValue&&this.scriptService.cleanup(),e&&e.useGlobalDomain&&!e.useGlobalDomain.firstChange&&e.useGlobalDomain.currentValue!==e.useGlobalDomain.previousValue&&this.scriptService.cleanup(),this.setupCaptcha=!0}getResponse(){return this.reCaptchaApi.getResponse(this.captchaId)}getCaptchaId(){return this.captchaId}resetCaptcha(){this.zone.run(()=>{this.reCaptchaApi.reset(),this.onChange(void 0),this.onTouched(void 0),this.reset.next()})}getCurrentResponse(){return this.currentResponse}reloadCaptcha(){this.setupComponent()}ensureCaptchaElem(e){let i=document.getElementById(e);if(!i)throw Error(`Captcha element with id '${e}' was not found`);this.captchaElem=i}renderReCaptcha(){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.captchaId=this.reCaptchaApi.render(this.captchaElemId,this.getCaptchaProperties()),this.ready.next()},0)})}handleCallback(e){this.currentResponse=e,this.success.next(e),this.zone.run(()=>{this.onChange(e),this.onTouched(e)}),this.resetCaptchaAfterSuccess&&this.resetCaptcha()}getPseudoUniqueNumber(){return new Date().getUTCMilliseconds()+Math.floor(Math.random()*9999)}setupComponent(){this.captchaSpecificSetup(),this.createAndSetCaptchaElem(),this.scriptService.registerCaptchaScript({useGlobalDomain:this.useGlobalDomain,useEnterprise:this.useEnterprise},"explicit",e=>{this.onloadCallback(e)},this.hl)}onloadCallback(e){if(this.reCaptchaApi=e,!this.reCaptchaApi)throw Error("ReCaptcha Api was not initialized correctly");this.isLoaded=!0,this.load.next(),this.renderReCaptcha(),this.setupAfterLoad&&(this.setupAfterLoad=!1,this.setupComponent())}generateNewElemId(){return this.captchaElemPrefix+this.getPseudoUniqueNumber()}createAndSetCaptchaElem(){if(this.captchaElemId=this.generateNewElemId(),!this.captchaElemId)throw Error("Captcha elem Id is not set");if(!this.captchaWrapperElem)throw Error("Captcha DOM element is not initialized");this.captchaWrapperElem.nativeElement.innerHTML="";let e=this.renderer.createElement("div");e.id=this.captchaElemId,this.renderer.appendChild(this.captchaWrapperElem.nativeElement,e),setTimeout(()=>{this.captchaElemId&&this.ensureCaptchaElem(this.captchaElemId)},0)}writeValue(e){}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}handleErrorCallback(){this.zone.run(()=>{this.onChange(void 0),this.onTouched(void 0)}),this.error.next()}handleExpireCallback(){this.expire.next(),this.resetCaptcha()}static \u0275fac=function(i){return new(i||t)(s(w),s(h),s(m),s(l))};static \u0275dir=v({type:t,inputs:{siteKey:"siteKey",useGlobalDomain:"useGlobalDomain",useEnterprise:"useEnterprise",type:"type",hl:"hl",tabIndex:"tabIndex"},outputs:{success:"success",load:"load",reset:"reset",ready:"ready",error:"error",expire:"expire"},features:[f]})}return t})(),O=(function(t){return t[t.InvisibleReCaptcha=0]="InvisibleReCaptcha",t[t.ReCaptcha2=1]="ReCaptcha2",t})(O||{});var B=(()=>{class t extends P{renderer;zone;injector;scriptService;windowOnErrorCallbackProperty="ngx_captcha_error_callback";windowOnExpireCallbackProperty="ngx_captcha_expire_callback";theme="light";size="normal";captchaWrapperElem;recaptchaType=O.ReCaptcha2;constructor(e,i,r,a){super(e,i,r,a),this.renderer=e,this.zone=i,this.injector=r,this.scriptService=a}ngOnChanges(e){super.ngOnChanges(e)}ngOnDestroy(){window[this.windowOnErrorCallbackProperty]={},window[this.windowOnExpireCallbackProperty]={}}captchaSpecificSetup(){this.registerCallbacks()}getCaptchaProperties(){return{sitekey:this.siteKey,callback:e=>this.zone.run(()=>this.handleCallback(e)),"expired-callback":()=>this.zone.run(()=>this.handleExpireCallback()),"error-callback":()=>this.zone.run(()=>this.handleErrorCallback()),theme:this.theme,type:this.type,size:this.size,tabindex:this.tabIndex}}registerCallbacks(){window[this.windowOnErrorCallbackProperty]=super.handleErrorCallback.bind(this),window[this.windowOnExpireCallbackProperty]=super.handleExpireCallback.bind(this)}static \u0275fac=function(i){return new(i||t)(s(w),s(h),s(m),s(l))};static \u0275cmp=b({type:t,selectors:[["ngx-recaptcha2"]],viewQuery:function(i,r){if(i&1&&x(N,5),i&2){let a;k(a=z())&&(r.captchaWrapperElem=a.first)}},inputs:{theme:"theme",size:"size"},standalone:!1,features:[D([{provide:S,useExisting:C(()=>t),multi:!0}]),y,f],decls:2,vars:0,consts:[["captchaWrapperElem",""]],template:function(i,r){i&1&&I(0,"div",null,0)},encapsulation:2})}return t})(),M=(()=>{class t{scriptService;zone;constructor(e,i){this.scriptService=e,this.zone=i}execute(e,i,r,a,n){this.executeAsPromise(e,i,a).then(r).catch(o=>n?n(o):console.error(o))}executeAsPromise(e,i,r){return new Promise((a,n)=>{let o=r||{},R=G=>{this.zone.runOutsideAngular(()=>{try{G.execute(e,{action:i}).then(d=>this.zone.run(()=>a(d)))}catch(d){n(d)}})};this.scriptService.registerCaptchaScript(o,e,R)})}static \u0275fac=function(i){return new(i||t)(p(l),p(h))};static \u0275prov=u({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),K=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=E({type:t});static \u0275inj=g({providers:[l,M],imports:[j]})}return t})();export{B as a,K as b};
