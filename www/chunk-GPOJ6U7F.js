import{a as f}from"./chunk-DADNZVRM.js";import{Ia as h,e as c,r as p,u as d}from"./chunk-3YJH32OC.js";var E=(()=>{let o=class o{constructor(t){this.http=t,this.apiUrl=f.apiUrl,this.reviewEndpoint=`${this.apiUrl}/reviews`,this.photosEndpoint=`${this.apiUrl}/photos`}createReview(t){return console.log("\u{1F4E6} Enviando comentario y rating para place_id:",t.place_id),this.http.post(this.reviewEndpoint,t)}uploadPhoto(t){let e=new FormData;e.append("place_id",t.place_id.toString());let n=t.photo,i=this.b64toBlob(n,"image/jpeg");return e.append("photo",i,`photo-${Date.now()}.jpeg`),t.description&&e.append("description",t.description),console.log("\u{1F4F8} Subiendo foto para place_id:",t.place_id),this.http.post(this.photosEndpoint,e)}getReviews(){return console.log("Fetching all reviews..."),this.http.get(this.reviewEndpoint)}getReviewsByPlaceId(t){return console.log(`Fetching and filtering reviews for Place ID: ${t}`),this.http.get(this.reviewEndpoint).pipe(c(e=>{if(e.success&&e.data){let n=e.data.filter(i=>i.place_id===t);return console.log(`\u2705 Filtrado local: ${n.length} rese\xF1as encontradas para ID ${t}.`),{success:!0,data:n}}return e}))}b64toBlob(t,e="",n=512){let i=atob(t),s=[];for(let a=0;a<i.length;a+=n){let u=i.slice(a,a+n),m=new Array(u.length);for(let l=0;l<u.length;l++)m[l]=u.charCodeAt(l);let g=new Uint8Array(m);s.push(g)}return new Blob(s,{type:e})}};o.\u0275fac=function(e){return new(e||o)(d(h))},o.\u0275prov=p({token:o,factory:o.\u0275fac,providedIn:"root"});let r=o;return r})();var U=(()=>{let o=class o{constructor(t){this.http=t,this.apiUrl=f.apiUrl,this.placesEndpoint=`${this.apiUrl}/places`}createPlace(t){return console.log("\u{1F4E6} Creando nuevo lugar:",t.name),this.http.post(this.placesEndpoint,t)}getPlaceById(t){console.log(`\u{1F5FA}\uFE0F Buscando lugar ID: ${t} usando filtro query.`);let e={place_id:t.toString()};return this.http.get(this.placesEndpoint,{params:e}).pipe(c(n=>{let i=n.data?.find(s=>s.id===t);return i&&i.id!==t&&console.warn(`\u26A0\uFE0F ALERTA: La API devolvi\xF3 el lugar ID ${i.id} cuando se solicit\xF3 el ID ${t}. Hay un problema en el backend.`),i||null}))}};o.\u0275fac=function(e){return new(e||o)(d(h))},o.\u0275prov=p({token:o,factory:o.\u0275fac,providedIn:"root"});let r=o;return r})();export{E as a,U as b};
